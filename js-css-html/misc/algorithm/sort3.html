<!DOCTYPE HTML>
<html>
<head>
	<title></title>
	<style type="text/css">
	#contanier{ margin:0 auto; width:700px;}
	#data{float:left; width:200px; height:500px; overflow:scroll; border:1px solid #000;
		margin-left:20px;}
	#mid{float:left; width:200px; margin:40px 30px 0 30px;}
	#result{float:left; width:200px; height:500px; overflow:scroll; border:1px solid #000;}
	</style>
	<script type="text/javascript">
	    function $(id) { return typeof id == "string" ? document.getElementById(id) : id; }
	    var data, result, num, createBtn, bubbleBtn, selecBtn, insertBtn, shellBtn, quickBtn,
            qStackBtn, mergeBtn, heapBtn;
	    var randnumArr = [];
	    function creatNum(num) {
	        //data.removeChild();
	        randnumArr = [];
	        if (num.toString() == 'NaN' || num <= 0) { // 注意：NaN != NaN
	            alert("请输入大于0的数字");
	        } else {
	            var oFragment = document.createDocumentFragment();
	            for (var i = 0; i < num; ++i) {
	                //data.innerHTML += "<div>" + parseInt(2 * num * Math.random()) + "</div>";
	                //这样会使页面短暂假死，因为对DOM更新的次数过多。 
	                var div = document.createElement("div");
	                randnumArr.push(parseInt(2 * num * Math.random()));
	                div.appendChild(document.createTextNode(randnumArr[i]));
	                oFragment.appendChild(div);
	            }
	            data.appendChild(oFragment); //只会对DOM更新一次。 
            }
	    }
	    function creatRes(arr) {
	        while (result.firstChild) {
	            result.removeChild(result.firstChild);
	        }
	        var oFragment = document.createDocumentFragment();
	        for (var i = 0; i < randnumArr.length; ++i) {
	            var div = document.createElement("div");
	            div.appendChild(document.createTextNode(arr[i]));
	            oFragment.appendChild(div);
	        }
	        result.appendChild(oFragment); //只会对DOM更新一次。 
	    }
	    function swap(arr, x, y) {
	        arr[x] = arr[x] + arr[y];
	        arr[y] = arr[x] - arr[y];
	        arr[x] = arr[x] - arr[y];
        }
        function bubbleSort() {
            var st = (new Date()).getTime();
			
			var n=0;
	        for (var i = 1, len = randnumArr.length; i < len; ++i) {
	            for (var j = 0; j < len - i; ++j) {
	                if (randnumArr[j] > randnumArr[j + 1]) swap(randnumArr, j, j + 1);
					n++;
                }
	        }
			alert(n);
			
	        alert((new Date()).getTime() - st + " ms");
	        creatRes(randnumArr);
        }
        function selectionSort() {
            var st = (new Date()).getTime();

            var n = 0;
            for (var i = 0, len = randnumArr.length; i < len; ++i) {
                var index = i;
                for (var j = i + 1; j < len; ++j) {
                    if (randnumArr[j] < randnumArr[index]) index = j;
					n++;
	            }
	            swap(randnumArr, i, index);
            }
			alert(n);

            alert((new Date()).getTime() - st + " ms");
            creatRes(randnumArr);
        }
        function insertionSort() {
            var st = (new Date()).getTime();

            var n = 0;
            var temp = 0;
            for (var i = 1, len = randnumArr.length; i < len; ++i) {
                var index = -1;
                for (var j = i - 1; j >= 0; --j) {
					n++;
                    if (randnumArr[i] >= randnumArr[j]) {
                        index = j;
                        break;
                    }
                }
                temp = randnumArr[i];
                var p = i;
                while (p > index + 1) {
					n++;
                    randnumArr[p] = randnumArr[p - 1];
                    p--;
                }
                randnumArr[index + 1] = temp;
            }
			alert(n);

            alert((new Date()).getTime() - st + " ms");
            creatRes(randnumArr);
        }
        function shellSort() {
            var st = (new Date()).getTime();

            var num = 0;
            var n = parseInt(randnumArr.length / 2);
            while (n >= 1) {
                for (var i = 0; i < n; i++) {
                    for (var j = i, len = randnumArr.length; j < len; j += n) {
                        var p = i, q = randnumArr[j + n];
                        if (q == undefined) break;
                        while (p != j + n && q >= randnumArr[p]) {
                            p += n;
                            num++;
                        }
                        //if (p >= len) break;
                        var o = j + n;
                        while (p < o) {
                            randnumArr[o] = randnumArr[o - n];
                            o = o - n;
                            num++;
                        }
                        randnumArr[p] = q;
                    }
                }
                n = parseInt(n / 2);
            }
            alert(num);
            alert((new Date()).getTime() - st + " ms");
            creatRes(randnumArr);
        }
        function quickSort(low,hi) {
            //var st = (new Date()).getTime();
            var l = low, r = hi;
            if (l >= r) return;
            var key = randnumArr[l];
            while (l < r) {
                while (l < r && randnumArr[r] >= key) r--;
                randnumArr[l] = randnumArr[r];
                while (l < r && randnumArr[l] <= key) l++;
                randnumArr[r] = randnumArr[l];
                //swap(randnumArr, l, r);
                //l++;
                //r--;
            }
            randnumArr[l] = key;
            quickSort(low, l - 1);
            quickSort(l + 1, hi);

            //alert((new Date()).getTime() - st + " ms");
            //creatRes(randnumArr);
        }
        function qStackSort() {
            var st = (new Date()).getTime();

            alert((new Date()).getTime() - st + " ms");
            creatRes();
        }
        function mergeSort() {
            var st = (new Date()).getTime();

            alert((new Date()).getTime() - st + " ms");
            creatRes();
        }
        function heapSort() {
            var st = (new Date()).getTime();

            alert((new Date()).getTime() - st + " ms");
            creatRes();
        }
        window.onload = function () {
            data = $("data");
            result = $("result");
            num = $("num");
            createBtn = $("create");
            bubbleBtn = $("bubble");
            selecBtn = $("selection");
            insertBtn = $("insertion");
            shellBtn = $("shell");
            quickBtn = $("quick");
            qStackBtn = $("stackQuick");
            mergeBtn = $("merge");
            heapBtn = $("heap");

            creatNum(parseInt(num.value));
            createBtn.onclick = function () {
                //data.removeChild();
                while (data.firstChild) {
                    data.removeChild(data.firstChild);
                }
                creatNum(parseInt(num.value));
            }
            bubbleBtn.onclick = bubbleSort;
            selecBtn.onclick = selectionSort;
            insertBtn.onclick = insertionSort;
            shellBtn.onclick = shellSort;
            quickBtn.onclick = function () {
                quickSort(0, randnumArr.length - 1); 
                creatRes(randnumArr); 
            }
            qStackBtn.onclick = qStackSort;
            mergeBtn.onclick = mergeSort;
            heapBtn.onclick = heapSort;

        }
	</script>
</head>
<body>
	<!--   -->
	<div id="contanier">
		<div id="data"></div>
		<div id="mid">
		<span>数据量：</span><input type="text" id="num" value="500" /><br />
		<input type="button" id="create" value="生成" /><br /><br /><br /><br />
		<!--<input type="button" id="reset" value="冒泡排序" /><br /><br />-->
		<input type="button" id="bubble" value="冒泡排序" /><br /><br />
		<input type="button" id="selection" value="选择排序" /><br /><br />
		<input type="button" id="insertion" value="插入排序" /><br /><br />
		<input type="button" id="shell" value="希尔排序" /><br /><br />
		<input type="button" id="quick" value="快排（递归）" /><br /><br />
		<input type="button" id="stackQuick" value="快排（堆栈）" /><br /><br />
		<input type="button" id="merge" value="归并排序" /><br /><br />
		<input type="button" id="heap" value="堆排序" />
		</div>
		<div id="result"></div>
	</div>
	<script type="text/javascript">
		/* 排序算法 */
	    
	</script>
</body>
</html>