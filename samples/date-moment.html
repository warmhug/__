<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Date</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/locale/zh-cn.js"></script>
</head>
<body>
<script>
  /** 
   https://momentjs.com/
   moment 对象里的 `_d` 不管是否为 UTC 时间、始终表示“本地时间”，参考构造函数：https://github.com/moment/moment/blob/b8a7fc310eb3625e83fc0c8f1ea2840fa83c7378/src/lib/moment/constructor.js#L62
   
    Modularize moment.js https://github.com/moment/moment/issues/2373
    https://github.com/JerrySievert/date-utils
    https://github.com/date-fns/date-fns
    https://www.npmjs.com/package/dateformat
    */
  console.log(moment([2010, 11, 29, 10, 59, 59, 300])); // 参数: 年 月 日 时 分 秒 毫秒
  console.log(moment.utc([2010, 11, 29, 10, 59, 59, 300])); // 参数: 年 月 日 时 分 秒 毫秒。utc 时间

  console.log(moment().format(), moment.locale(), moment().isLeapYear());
  console.log(moment().utcOffset(0), moment().utcOffset(), new Date().getTimezoneOffset());
  console.log(moment().utcOffset(0).format(), moment().utcOffset(8).format());
  console.log(moment().utcOffset(8), moment().locale('zh-cn').utcOffset(8));
  console.log(moment().utcOffset(8).hours(), moment().locale('zh-cn').utcOffset(8).hours());
  console.log(moment.utc(), moment.utc().format());

  console.log(moment("2010-10-20T04:30+0000")); // 标准 ISO 格式
  // console.log(moment("2010-10-20 4:30 +0000")); // 非 ISO 格式，moment 提醒错误
  console.log(moment("2010-10-20 4:30 +0000", "YYYY-MM-DD").format()); // 格式化非 ISO 格式

  // 非 ISO 格式，未指定时区，默认使用本地时区
  console.log(moment("2010-10-20 4:30",       "YYYY-MM-DD HH:mm"));
  // 非 ISO 格式，指定时区，用 moment 指定格式化为 UTC 时间 (Z: Offset from UTC)
  console.log(moment("2010-10-20 4:30 +0000", "YYYY-MM-DD HH:mm Z"));


  var time1 = moment().utcOffset(12);
  var time2 = moment();
  console.log(time1.isSame(time2, 'day')); // TRUE
  console.log(time1.utc().format('MM-DD-YYYY')); //
  console.log(time2.utc().format('MM-DD-YYYY')); //

  var now = moment();
  console.log(now.year(), now.month(), now.date(), now.hour(), now.minute())
  console.log(now.clone().endOf('month').date())
  console.log(now.year(2016), now.month(1), now.date(5))
  console.log(moment([2000, 1, 1, 0, 0, 0]).toString())
  console.log(new Date(2000, 1, 1, 0, 0, 0).toString())
  console.log(moment([2017, 6, 13, 0, 10, 10]).isBefore(moment(), 'day'))
</script>

<script>
  // Note: 边界时间、越界时间、非法时间. 主要是在 setMonth 时出现：
  // Note: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/setMonth
  // e.g. from 2017-03-31 to 2017-02-28
  var d1 = new Date(2017, 2, 31, 15, 1, 1);
  var dm = moment([2017, 2, 31, 15, 1, 1]);
  d1.setMonth(13);
  dm.month(13);  // moment 对越界时间的处理、与原生不同！
  console.log(d1, dm);

  function setMonth(date, month) {
    date.setDate(Math.min(date.getDate(), lastDayOfMonth(new Date(date.getFullYear(), month))));
    date.setMonth(month);
  }
  var bd = new Date(2017, 2, 31);
  setMonth(bd, 1);
  console.log(bd);
</script>

</body>
</html>
